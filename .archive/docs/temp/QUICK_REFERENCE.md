# üöÄ QUICK REFERENCE - CHAT SYSTEEM

## üî• MEEST GEBRUIKTE BESTANDEN

### 1. Jules' Persoonlijkheid Aanpassen
**Bestand**: `api/chat/route.ts`
**Regel**: 9-55

```typescript
const SYSTEM_PROMPT = `Je bent Jules Zwijsen...`
```

### 2. Conversatie Regels
**Bestand**: `api/chat/route.ts`
**Regel**: 19-38

### 3. Veld Auto-Hints
**Bestand**: `config/field-ids.ts`

```typescript
budget: {
  julesQuestion: 'Wat is je budget? Inclusief BTW?'
}
```

### 4. RAG Keywords
**Bestand**: `api/chat/route.ts`
**Regel**: 90-95

```typescript
const technicalKeywords = [
  'fundering', 'isolatie', 'dak', // voeg toe
]
```

---

## ‚ö° SNELLE WIJZIGINGEN

### Jules praat te veel?
**File**: `api/chat/route.ts`
**Line**: 143
```typescript
max_tokens: 500  // Verlaag naar 300
```

### Jules te formeel?
**File**: `api/chat/route.ts`
**Line**: 9-17
```typescript
// Voeg toe:
- Informeel, vriendelijk
- Gebruikt "je" niet "u"
```

### Verkeerde projecttype detectie?
**File**: `api/chat/route.ts`
**Line**: 26-29
```typescript
// Pas logica aan:
PROJECTTYPE DETECTIE:
- Als gebruiker over een BESTAAND HUIS praat ‚Üí VERBOUWING
```

---

## üéØ BELANGRIJKSTE API CALLS

### Chat Versturen
```typescript
POST /api/chat
Body: {
  messages: Message[],
  projectType: 'nieuwbouw' | 'verbouwing',
  hasLocation: boolean,
  focusedField: string,
  isAutoGenerated: boolean
}
```

### Vector Search
```typescript
POST /api/vector-search
Body: {
  query: string,
  projectType: string,
  limit: 3,
  similarityThreshold: 0.7
}
```

---

## üîß DEBUG COMMANDS

```bash
# Bekijk chat logs
tail -f logs/chat.log

# Test single chat call
curl -X POST http://localhost:3000/api/chat \
  -H "Content-Type: application/json" \
  -d '{"messages":[{"role":"user","content":"Hallo"}]}'

# Check Zustand state (browser console)
useWizardStore.getState()
```

---

## üìä METRICS

- **Model**: GPT-4o-mini (60x goedkoper dan GPT-4)
- **Temperature**: 0.7 (creatief maar consistent)
- **Max tokens**: 500 (kort & bondig)
- **RAG threshold**: 0.7 similarity
- **Debounce delay**: 500ms (auto-hints)

---

## üé® UI COMPONENTS QUICK LIST

```typescript
ChatInterface.tsx        // ‚≠ê Main logic
ChatMessage.tsx          // üí¨ Message display
ChatInput.tsx            // ‚å®Ô∏è Input field
TypingIndicator.tsx      // ‚è≥ "Typing..."
HumanHandoffModal.tsx    // üÜò Help modal
PrioritizationView.tsx   // üéØ MoSCoW UI
```

---

## üîë ENVIRONMENT VARIABLES

```bash
OPENAI_API_KEY=sk-...           # Required
NEXT_PUBLIC_APP_URL=...         # For RAG
SUPABASE_URL=...                # For vector DB
SUPABASE_ANON_KEY=...           # For vector DB
```

---

**Update**: 2025-12-16
